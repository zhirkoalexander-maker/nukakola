<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base Defense - Play Online</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            color: #e0e0e0;
        }
        
        .game-container {
            background: rgba(15, 52, 96, 0.9);
            border: 3px solid #64dd17;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(100, 221, 23, 0.5);
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            color: #64dd17;
        }
        
        .header h1 {
            font-size: 2.5em;
            text-shadow: 0 0 10px #64dd17;
            margin-bottom: 5px;
        }
        
        .header p {
            color: #b0e0e6;
            font-size: 1.1em;
        }
        
        canvas {
            display: block;
            background: #000;
            border: 2px solid #64dd17;
            margin: 0 auto;
            width: 100%;
            max-width: 1280px;
        }
        
        .controls {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #533483;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            color: #b0e0e6;
        }
        
        .controls h3 {
            color: #64dd17;
            margin-bottom: 10px;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            font-size: 0.9em;
        }
        
        .control-group {
            text-align: left;
        }
        
        .control-group strong {
            color: #76ff03;
            display: block;
            margin-bottom: 5px;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            color: #b0e0e6;
            font-size: 0.9em;
        }
        
        .footer a {
            color: #64dd17;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .fps {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 10px 15px;
            border-radius: 5px;
            font-family: monospace;
            border: 1px solid #00ff00;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>‚öîÔ∏è BASE DEFENSE</h1>
            <p>Tower Builder Strategy Game - Play Online</p>
        </div>
        
        <canvas id="gameCanvas" width="1280" height="720"></canvas>
        
        <div class="controls">
            <h3>üéÆ Game Controls</h3>
            <div class="controls-grid">
                <div class="control-group">
                    <strong>Movement</strong>
                    <span>W/A/S/D - Move</span>
                </div>
                <div class="control-group">
                    <strong>Modes</strong>
                    <span>1 - Build | 2 - Break | 3 - Weapon</span>
                </div>
                <div class="control-group">
                    <strong>Weapons</strong>
                    <span>X-Sword | C-Axe | V-Spear | Z-Sniper | F-Hammer | L-Laser</span>
                </div>
                <div class="control-group">
                    <strong>Game</strong>
                    <span>P - Pause | ESC - Menu | Click - Use Mode</span>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>üíæ Saving to browser storage | üì¶ <a href="https://github.com/zhirkoalexander-maker/nukakola">View Source Code</a></p>
            <p>üéÆ Click canvas to focus before playing | Keyboard controls active</p>
        </div>
    </div>
    
    <div class="fps" id="fps">FPS: 60</div>
    
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game Variables
        const WIDTH = canvas.width;
        const HEIGHT = canvas.height;
        
        let gameState = 'menu';
        let playerX = WIDTH / 2;
        let playerY = HEIGHT / 2;
        let playerHealth = 100;
        let baseCoreHealth = 200;
        let money = 500;
        let score = 0;
        let wave = 1;
        let enemies = [];
        let blocks = [];
        let activeMode = 'weapon'; // 'build', 'break', 'weapon'
        let activeWeapon = 'sword';
        let gameRunning = true;
        let selectedBlock = 'wood';
        
        // Block types
        const BLOCKS = {
            wood: { color: '#8B5A2B', cost: 40, health: 40 },
            stone: { color: '#A9A9A9', cost: 80, health: 80 },
            brick: { color: '#CD6F2F', cost: 70, health: 60 },
            iron: { color: '#646464', cost: 150, health: 150 },
            diamond: { color: '#96DCFF', cost: 400, health: 300 }
        };
        
        // Enemies
        class Enemy {
            constructor(x, y, type = 'zombie') {
                this.x = x;
                this.y = y;
                this.type = type;
                this.speed = 1.5;
                this.health = 30;
                this.damage = 10;
                this.size = 15;
            }
            
            draw() {
                ctx.fillStyle = '#ff6b6b';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                
                // Health bar
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(this.x - this.size, this.y - this.size - 10, this.size * 2, 3);
                ctx.fillStyle = '#00ff00';
                ctx.fillRect(this.x - this.size, this.y - this.size - 10, (this.size * 2) * (this.health / 30), 3);
            }
            
            update() {
                // Move towards base
                const dx = playerX - this.x;
                const dy = playerY - this.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist > 0) {
                    this.x += (dx / dist) * this.speed;
                    this.y += (dy / dist) * this.speed;
                }
            }
        }
        
        // Block
        class Block {
            constructor(x, y, type = 'wood') {
                this.x = x;
                this.y = y;
                this.type = type;
                this.size = 40;
                this.health = BLOCKS[type].health;
                this.maxHealth = BLOCKS[type].health;
            }
            
            draw() {
                ctx.fillStyle = BLOCKS[this.type].color;
                ctx.fillRect(this.x, this.y, this.size, this.size);
                
                // Border
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.strokeRect(this.x, this.y, this.size, this.size);
                
                // Health bar if damaged
                if (this.health < this.maxHealth) {
                    ctx.fillStyle = '#ff0000';
                    ctx.fillRect(this.x, this.y - 5, this.size, 3);
                    ctx.fillStyle = '#00ff00';
                    ctx.fillRect(this.x, this.y - 5, (this.size) * (this.health / this.maxHealth), 3);
                }
            }
        }
        
        // Draw functions
        function drawMenu() {
            ctx.fillStyle = 'rgba(26, 26, 46, 0.9)';
            ctx.fillRect(0, 0, WIDTH, HEIGHT);
            
            // Title
            ctx.fillStyle = '#64dd17';
            ctx.font = 'bold 60px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('BASE DEFENSE', WIDTH / 2, 100);
            
            // Subtitle
            ctx.fillStyle = '#b0e0e6';
            ctx.font = '24px Arial';
            ctx.fillText('Tower Builder Strategy Game', WIDTH / 2, 150);
            
            // Start button
            ctx.fillStyle = '#64dd17';
            ctx.fillRect(WIDTH / 2 - 150, HEIGHT / 2, 300, 60);
            ctx.fillStyle = '#000';
            ctx.font = 'bold 28px Arial';
            ctx.fillText('CLICK TO START', WIDTH / 2, HEIGHT / 2 + 45);
            
            // Info
            ctx.fillStyle = '#b0e0e6';
            ctx.font = '16px Arial';
            ctx.fillText('Defend your base from enemy waves', WIDTH / 2, HEIGHT - 100);
            ctx.fillText('Build blocks, hire units, defeat enemies', WIDTH / 2, HEIGHT - 60);
        }
        
        function drawGame() {
            // Background
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, WIDTH, HEIGHT);
            
            // Draw blocks
            blocks.forEach(block => block.draw());
            
            // Draw base core
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(playerX, playerY, 20, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#FFA500';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Draw enemies
            enemies.forEach(enemy => enemy.draw());
            
            // Draw player
            ctx.fillStyle = '#00ff00';
            ctx.fillRect(playerX - 15, playerY - 15, 30, 30);
            ctx.strokeStyle = '#64dd17';
            ctx.lineWidth = 2;
            ctx.strokeRect(playerX - 15, playerY - 15, 30, 30);
            
            // Draw UI
            ctx.fillStyle = '#64dd17';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`Wave: ${wave}`, 10, 30);
            ctx.fillText(`Enemies: ${enemies.length}`, 10, 60);
            ctx.fillText(`Money: $${money}`, 10, 90);
            ctx.fillText(`Health: ${playerHealth}`, 10, 120);
            ctx.fillText(`Base: ${baseCoreHealth}`, 10, 150);
            
            // Right side UI
            ctx.textAlign = 'right';
            ctx.fillText(`Mode: ${activeMode}`, WIDTH - 10, 30);
            ctx.fillText(`Weapon: ${activeWeapon}`, WIDTH - 10, 60);
            ctx.fillText(`Score: ${score}`, WIDTH - 10, 90);
            
            // Instructions
            ctx.fillStyle = '#b0e0e6';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Click to place blocks | Press 1/2/3 for modes | X-L for weapons', WIDTH / 2, HEIGHT - 10);
        }
        
        function updateGame() {
            // Update enemies
            enemies.forEach(enemy => {
                enemy.update();
            });
            
            // Remove dead enemies
            enemies = enemies.filter(e => e.health > 0);
            
            // Check collision with player
            enemies.forEach(enemy => {
                const dx = enemy.x - playerX;
                const dy = enemy.y - playerY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < 40) {
                    playerHealth -= 0.1;
                    baseCoreHealth -= 0.05;
                }
            });
            
            // Game over check
            if (baseCoreHealth <= 0) {
                gameState = 'gameover';
            }
            
            // Wave completion
            if (enemies.length === 0 && wave > 0) {
                wave++;
                spawnWave();
            }
        }
        
        function spawnWave() {
            const enemyCount = 3 + wave;
            for (let i = 0; i < enemyCount; i++) {
                const angle = (Math.PI * 2 * i) / enemyCount;
                const x = WIDTH / 2 + Math.cos(angle) * 600;
                const y = HEIGHT / 2 + Math.sin(angle) * 400;
                enemies.push(new Enemy(x, y));
            }
        }
        
        function draw() {
            if (gameState === 'menu') {
                drawMenu();
            } else if (gameState === 'playing') {
                drawGame();
            }
        }
        
        function update() {
            if (gameState === 'playing') {
                updateGame();
            }
        }
        
        // Input handling
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            
            if (e.key === '1') activeMode = 'build';
            if (e.key === '2') activeMode = 'break';
            if (e.key === '3') activeMode = 'weapon';
            
            if (e.key.toLowerCase() === 'x') activeWeapon = 'sword';
            if (e.key.toLowerCase() === 'c') activeWeapon = 'axe';
            if (e.key.toLowerCase() === 'v') activeWeapon = 'spear';
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });
        
        // Mouse click
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            if (gameState === 'menu') {
                // Start game
                if (x > WIDTH / 2 - 150 && x < WIDTH / 2 + 150 && y > HEIGHT / 2 && y < HEIGHT / 2 + 60) {
                    gameState = 'playing';
                    enemies = [];
                    blocks = [];
                    spawnWave();
                }
            } else if (gameState === 'playing') {
                if (activeMode === 'build' && money >= BLOCKS[selectedBlock].cost) {
                    const gridX = Math.floor(x / 40) * 40;
                    const gridY = Math.floor(y / 40) * 40;
                    blocks.push(new Block(gridX, gridY, selectedBlock));
                    money -= BLOCKS[selectedBlock].cost;
                } else if (activeMode === 'weapon') {
                    // Attack enemies
                    enemies.forEach(enemy => {
                        const dx = enemy.x - x;
                        const dy = enemy.y - y;
                        const dist = Math.sqrt(dx * dx + dy * dy);
                        if (dist < 100) {
                            enemy.health -= 25;
                            score += 10;
                        }
                    });
                }
            }
        });
        
        // Player movement
        function handleInput() {
            if (keys['w'] && playerY > 20) playerY -= 3;
            if (keys['s'] && playerY < HEIGHT - 20) playerY += 3;
            if (keys['a'] && playerX > 20) playerX -= 3;
            if (keys['d'] && playerX < WIDTH - 20) playerX += 3;
        }
        
        // FPS counter
        let fpsCounter = 0;
        let lastTime = Date.now();
        
        function updateFPS() {
            fpsCounter++;
            const currentTime = Date.now();
            if (currentTime - lastTime >= 1000) {
                document.getElementById('fps').textContent = `FPS: ${fpsCounter}`;
                fpsCounter = 0;
                lastTime = currentTime;
            }
        }
        
        // Game loop
        function gameLoop() {
            handleInput();
            update();
            draw();
            updateFPS();
            requestAnimationFrame(gameLoop);
        }
        
        // Start game loop
        gameLoop();
    </script>
</body>
</html>
